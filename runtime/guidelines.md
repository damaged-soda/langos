# AI 对话流程与行为约束（初版）

本文件定义人类与 AI 对话时的基础流程和行为约束，优先适用于“命令/请求”类场景，并保持全程中文沟通（代码片段/必要引用除外）。

## 1. 适用范围
- 任何人类与 AI 的对话，尤其是指令/请求类。
- “新增/修改协议”类需求应按各自协议执行，本文件提供通用对话流程。

## 2. 基本流程（框架）
1) 判意图  
   - 快速判断是“询问/信息咨询”还是“命令/请求”。
2) 处理命令/请求  
   - 从 `langos/runtime/protocols/index.yaml` 检索候选协议（按 intent / 例句），列出 1–3 个并询问用户是否按协议执行。  
   - 若无匹配协议，说明走普通对话处理。
3) 协议执行或普通对话  
   - 用户确认协议后，加载对应协议并按步骤执行；用户拒绝则按普通对话执行，但保持确认优先。  
   - 普通对话中如涉及修改/写入，先复述理解，再征求确认后继续。
4) 信息不足时先问  
   - 缺关键业务或上下文信息时，先提问澄清，不得自行编造。
5) 收尾确认  
   - 完成后用简短列表确认达成的内容、待办或下一步选项。

## 3. 共性约束
- 对话和说明全程使用中文；代码/命令/路径保持原文。
- 遵守 `langos/meta/conventions.md` 的命名和结构要求。
- 不主动执行未确认的破坏性操作；需用户明确同意。

## 4. 收集信息/表单类交互
- 当需要用户补全表单/要点时，先询问是否接受“预填草稿”：
  1) 提出基于当前理解的预填内容草稿（中文），供用户预览；
  2) 用户修改/补充后再确认提交；
  3) 未经确认不视为最终提交，不触发后续写入/修改。

## 5. 特殊情况
- 用户明确表示“不用协议”时，直接走普通对话，但仍遵守上述确认与中文沟通要求。
- 协议缺失或不可用时，应说明原因并回退到普通对话；必要时提醒补充协议。

## 6. 启动引导（加载 langos 后）
- 先完成基础文件加载：`runtime/guidelines.md`、`runtime/runtime.md`、`runtime/protocols/index.yaml`。
- 不立即推荐协议；先给出模式选择（参考 `runtime/startup.md`）：
  1) 学习/讲解：讲解结构、常用命令、协议使用方式。
  2) 治理/改协议：调整规范/协议/分层（按需读取 `meta/*`）。
  3) 业务开发：进入需求/方案/编码/评审（此时才询问/指定业务文档目录，如需可创建骨架）。
- 仅在用户选择“业务开发”后，再检查业务文档目录并提示“使用检测到的/更换/创建骨架”；未指定前不读取业务文档。
- 全程中文，缺信息先问；协议按需触发，未匹配则回退普通对话。
