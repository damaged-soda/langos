# 启动引导模板（加载 langos 后输出）

> 供 codex/AI 在 `work/` 目录加载 langos 成功后使用。先校验文档目录与自举上下文，再进入模式选择。

## 启动与文档目录确认

- 读取仓根配置（优先 `.langos-local.yaml`，其次 `.langos.yaml`）的 `doc_root`，**仅校验路径存在，不读取或暴露内容**；`doc_root` 为业务/背景文档相对目录，可选示例 `../langos-docs/` 指向同级 docs 仓。
- 若未读取到或目录不存在，标记为“未指定/未找到”，仅在需要读取业务/背景文档时再提示用户指定；未确认前不读取业务文档。
- 启动时复述：已处于 langos 运行时，治理/运行时在本仓，业务文档不在本仓；自举（治理）为业务流程特例，可参考 `langos-docs/repos/langos/specs/self-boot-mode-spec.md` 但运行时最小集无需依赖 docs。

## 模式选择（统一入口）

```
已加载 langos（自然语言编程 OS 内核，治理/运行时在本仓，业务文档不在本仓）。
当前文档目录（仅校验存在，未读取内容）：<来自配置或用户指定的 doc_root，未指定则提示“未指定，可在需要读取业务文档时指定”>

请选择模式（输入数字即可）：
1) 学习/讲解：帮我快速讲解项目结构、常用命令或如何使用协议
2) 治理/改协议：调整规范/协议/分层（自举为业务流程特例，按自举 SOP，进入后按需读取文档）
3) 业务开发：进入需求/方案/编码/评审流程（需要业务文档目录，由你指定/配置）
```

## 后续处理原则

- 启动阶段仅校验 `doc_root` 是否存在，不读取业务/背景文档内容；doc_root 缺省时也可按最小集运行。
- “学习/讲解”：不读取业务目录，可根据提问讲解 langos 结构、协议使用方式或示例命令。  
- “治理/改协议”：治理=业务流程特例，遵循自举 SOP，进入后按需参考 `langos-docs/repos/langos/*` 等文档；未指定 doc_root 时，先用最小集沟通，需要读文档时再提示指定。  
- “业务开发”：进入该模式后，再判断业务文档目录：  
  - 若已由配置/用户指定，则使用该目录；  
  - 若未指定，提示“指定业务目录”或“创建空业务骨架（示例 workspace/{repos,projects,domain,specs,adr,archive}）”；  
  指定后按需读取仓库索引/需求/项目文档，缺什么再问，不编造。  
- 未选择模式或未确认业务目录前，不读取业务文档；选择后记为本会话默认。  
- 全程可通过自然语言触发协议；无匹配协议时说明并回退普通对话。

## 模式选择（上下文切换）

请根据用户输入选择加载路径和行为模式：

### 1. 业务开发模式 (User Mode)
- **目标**：开发具体的业务应用。
- **工作区根目录**：用户指定的业务目录（如 `workspace/`）。
- **文档读取顺序**：`langos/runtime/*` -> `workspace/repos/INDEX.md`。
- **行为**：使用现有协议服务于业务需求。

### 2. 内核治理/自举模式 (Kernel Mode)
- **目标**：迭代 LangOS 本身（修改协议、规范或文档），复用业务开发的需求→方案→编码→评审流程。
- **工作区根目录**：**`langos/`（本仓根目录）**。
- **逻辑映射**：
    - 把 `langos/` 视为“当前 Repo”。
    - 把 `langos/docs_root`（来自配置或指定的 doc_root，例如 `langos-docs/`，可选）视为“业务/背景文档库”，进入治理后按需读取；未指定时按最小集继续。
    - 把 `langos/runtime` 视为“核心代码库”。
- **危险动作**：
    - 修改 `runtime/protocols/*.yaml` 时注意热更新风险，先明确需求与方案再落盘。
    - 修改 `runtime/conventions.md` 需检查对现有协议的破坏性。
