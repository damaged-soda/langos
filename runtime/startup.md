# 启动引导模板（加载 langos 后输出）

> 供 codex/AI 在 `work/` 目录加载 langos 成功后使用。先校验文档目录与自举上下文，再进入模式选择。

## 启动与文档目录确认

- 读取仓根配置（优先 `.langos-local.yaml`，其次 `.langos.yaml`）的 `doc_root`，作为业务/背景文档相对目录（相对于 langos 仓根，可用 `../langos-docs/` 指向同级 docs 仓）。
- 如未读取到或目录不存在，必须请用户显式指定文档目录后才能继续；未确认前不进入模式选择，也不读取业务文档。
- 启动时复述：已处于 langos 运行时，治理/运行时在本仓，业务文档不在本仓；自举模式需遵循 `langos-docs/repos/langos/specs/self-boot-mode-spec.md`。

## 模式选择（统一入口）

```
已加载 langos（自然语言编程 OS 内核，治理/运行时在本仓，业务文档不在本仓）。
当前文档目录：<来自配置或用户指定的 doc_root，未确认则提示“未指定，请先指定”>

请选择模式（输入数字即可）：
1) 学习/讲解：帮我快速讲解项目结构、常用命令或如何使用协议
2) 治理/改协议：调整规范/协议/分层（按自举 SOP，需已确认文档目录）
3) 业务开发：进入需求/方案/编码/评审流程（需要业务文档目录，由你指定/配置）
```

## 后续处理原则

- “学习/讲解”：不读取业务目录，可根据提问讲解 langos 结构、协议使用方式或示例命令。  
- “治理/改协议”：遵循自举 SOP，已确认文档目录后按需读取 `langos-docs/repos/langos/*` 与目标协议，保持需求→方案→实现→评审的确认闸门。  
- “业务开发”：进入该模式后，再判断业务文档目录：  
  - 若已由配置/用户指定，则使用该目录；  
  - 若未指定，提示“指定业务目录”或“创建空业务骨架（示例 workspace/{repos,projects,domain,specs,adr,archive}）”；  
  指定后按需读取仓库索引/需求/项目文档，缺什么再问，不编造。  
- 未选择业务目录前，不读取业务文档；选择后记为本会话默认。  
- 全程可通过自然语言触发协议；无匹配协议时说明并回退普通对话。

## 模式选择（上下文切换）

请根据用户输入选择加载路径和行为模式：

### 1. 业务开发模式 (User Mode)
- **目标**：开发具体的业务应用。
- **工作区根目录**：用户指定的业务目录（如 `workspace/`）。
- **文档读取顺序**：`langos/runtime/*` -> `workspace/repos/INDEX.md`。
- **行为**：使用现有协议服务于业务需求。

### 2. 内核治理/自举模式 (Kernel Mode)
- **目标**：迭代 LangOS 本身（修改协议、规范或文档）。
- **工作区根目录**：**`langos/`（本仓根目录）**。
- **逻辑映射**：
    - 把 `langos/` 视为“当前 Repo”。
    - 把 `langos/docs_root`（来自配置或指定的 doc_root，例如 `langos-docs/`）视为“业务/背景文档库”。
    - 把 `langos/runtime` 视为“核心代码库”。
- **危险动作**：
    - 修改 `runtime/protocols/*.yaml` 时注意热更新风险，先明确需求与方案再落盘。
    - 修改 `runtime/conventions.md` 需检查对现有协议的破坏性。
